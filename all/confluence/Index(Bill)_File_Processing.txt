title: Index(Bill) File Processing
body: (com.infoimage.processing.application.payebill.ProcessingJob)  
(generated by Nord(Nordis) for all the CRCM hospitals and send to infoimage)  
\- there is a cut off time to receive this  
\- when infoimage processes the index file it post links to pdf hosted by NORD  
\- payments section deal with index file data (only for auto pay balance is
used from balance sheet)  
\- deals with only bills due . So min due in index file typically would be sum
of the all the min dues for all accounts associated with a seed in balance
file. But it's not necc it's the same if patient goes to hospital after a bill
was generated.  
\- min due and total mininum due present in index file is used for bill
payment options

  * Tables Used  
bills  
p_bill_payment(p_job_id,new)

  * Job Exec  
\- this job processes bills. After this job processes an index file, the job
will be registered as auto-pay job meaning all bills processed by this job
will be used by the autopayment logic. The autopayment job find all bill jobs
for which autopayment hasn't be processed, then processes each bill for today
or future if autopayment has been set by the user  
\- payebill.bill.postOnlySeedBill in cid.conf file determines if we post bills
to belonging to guarantor account or if post to all accounts irrespective of
it's a seed or not  
\- file name convention  
CVHS_ms1.MM-DD-YYYY.XML.gpg (timestamp should be in PST)  
\- required fields in bold  
 **acctNbr**  |name |  **totalDue**  |  **minDue**  |*dueDate (MM/DD/YYYY)* |
**billingDate (MM/DD/YYYY)**  |  **docGUID**  | pageCount | docType |docTitle

acctNbr > guarantor account no of the seed

    * Skip processing for  
\- Missing/invalid data in any required field (red fields above)  
\- Guarantor accounts unsuccessfully processed in balance sheet will not be
processed in index file. Bills will only be posted for existing account
numbers.  
\- Negative amounts for totalDue and minDue are considered invalid data  
\- If only seed or all accounts bills is processed is determined by
"payebill.bill.postOnlySeedBill" which is set in the cid.conf file  
payebill.bill.postOnlySeedBill = false ( all accounts bills are posted seed
and non seed accounts)  
payebill.bill.postOnlySeedBill = true ( only seed related bills are posted) -
non seed bills are skipped you can see it in the processing log  
payebill.bill.postOnlySeedBill is not defined in the file then it is the same
as it being set to true.

  * Job Undo  
The undo when it is run either of the two things below can  
1) if in the file none of the bills have a payment associated with it then
undo goes through fine. Undo results in purging of data from the tables BILL,
P_JOB_BILL,P_JOB_EMAIL,P_BILL_PAYMEN,P_ESTMT_COUNT  
2) if any bill in the file has a payment associated with UNDO job gives and
exception. This is by design.


