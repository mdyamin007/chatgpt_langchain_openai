title: SFCE [22912] [pvt] eStatement Delivery Preference Update
description: SFCE eStatement Delivery Preference Update

*IS Assessment:*

The following applications will need to be modified with this logic:

SFCEMS5 (Statement) Tohid

SFCEMC3 (HELOC) Le

SFCEMC4 (Billing Statement) Nar

SFCEMV4 (Visa Business) Rony

SFCEMV5 (Visa Classic) Rony

SFCEMV6 (Visa Platinum) Rony

SFCEDLA (Daily Notices) Nar







1.) Update dfa program to no longer use paperless file from ISD.

2.) Update dfa program to use Delivery Preference bases on the XML field eStatementOption provided by statement data generated by KeyStone


 * eStateementOption have the following options
 ** [M Mail statement only (Print) (Status = P in ISD enrollment file)|https://owa.infoimageinc.com/owa/redir.aspx?C=V5PdpqwhgggBlqWzIu1xAZnyPmSmhYcDCDNIoM39Nq3nJVOayYHZCA..&URL=https%3a%2f%2fowa.infoimageinc.com%2fowa%2fredir.aspx%3fSURL%3dK_YcG0zvPl6Rk0scy08-ItTvoHgEkBDUuJTfV8lN9n4hJpBeN4HUCGgAdAB0AHAAOgAvAC8AdwB3AHcALgBpAG4AZgBvAGkAbQBhAGcAZQBpAG4AYwAuAGMAbwBtAC8A%26URL%3dhttp%253a%252f%252fwww.infoimageinc.com%252f]
 ** [E E-statement only  (eSup2) (Status = E in ISD enrollment file)|https://owa.infoimageinc.com/owa/redir.aspx?C=V5PdpqwhgggBlqWzIu1xAZnyPmSmhYcDCDNIoM39Nq3nJVOayYHZCA..&URL=https%3a%2f%2fowa.infoimageinc.com%2fowa%2fredir.aspx%3fSURL%3dK_YcG0zvPl6Rk0scy08-ItTvoHgEkBDUuJTfV8lN9n4hJpBeN4HUCGgAdAB0AHAAOgAvAC8AdwB3AHcALgBpAG4AZgBvAGkAbQBhAGcAZQBpAG4AYwAuAGMAbwBtAC8A%26URL%3dhttp%253a%252f%252fwww.infoimageinc.com%252f]
 ** [B E-statement and mail statement (Print) (Status = W in ISD enrollment file)|https://owa.infoimageinc.com/owa/redir.aspx?C=V5PdpqwhgggBlqWzIu1xAZnyPmSmhYcDCDNIoM39Nq3nJVOayYHZCA..&URL=https%3a%2f%2fowa.infoimageinc.com%2fowa%2fredir.aspx%3fSURL%3dK_YcG0zvPl6Rk0scy08-ItTvoHgEkBDUuJTfV8lN9n4hJpBeN4HUCGgAdAB0AHAAOgAvAC8AdwB3AHcALgBpAG4AZgBvAGkAbQBhAGcAZQBpAG4AYwAuAGMAbwBtAC8A%26URL%3dhttp%253a%252f%252fwww.infoimageinc.com%252f]
 ** [The default is M. Indicates whether or not the account is enrolled for e-statements.|https://owa.infoimageinc.com/owa/redir.aspx?C=V5PdpqwhgggBlqWzIu1xAZnyPmSmhYcDCDNIoM39Nq3nJVOayYHZCA..&URL=https%3a%2f%2fowa.infoimageinc.com%2fowa%2fredir.aspx%3fSURL%3dK_YcG0zvPl6Rk0scy08-ItTvoHgEkBDUuJTfV8lN9n4hJpBeN4HUCGgAdAB0AHAAOgAvAC8AdwB3AHcALgBpAG4AZgBvAGkAbQBhAGcAZQBpAG4AYwAuAGMAbwBtAC8A%26URL%3dhttp%253a%252f%252fwww.infoimageinc.com%252f]  (Status = P in ISD enrollment File)

3.) Remove cid&jid from /home/keep/paperless/paperless.lis file.

4.) Create a new ISD enrollment file and trigger ISD PUI server. This needs to be triggered after send trigger PUI statement processing. Order of the call matters! The following are the specifications:



Filenaming convention:

sfce(jid)_enrollment_MMDDYYYY.txt

e.g.:

sfcems5_enrollment_02252022.txt

Please file in $d_dir/isd_input/I3/process-files/sfce/





File Contents Specifications:

The fields required in this enrollment files are as listed below. Please include the following line as a heading in this file. For CIF Number field, please use the Account Number Value. The Status value specs are list above in step 2.



CIF Number|Account Number|Account Name|Email|Status



e.g.:

CIF Number|Account Number|Account Name|Email|Status

22222|22222|John Doe|jd@yahoo.com|E

54321|54321|Bib Miller|bmiller@gmail.com|W

99999|99999|Rachael Paxton|paxtonr@hotmail.com|P



Full ISD documentation is located in:

[https://confluence.infoimageinc.com/x/YxZ6B]





Trigger Logic:

I believe we can reuse /home/master/I3.socket.pl

Make sure enviroment variable e_paperless is set to y and paperlessFile environment variable is set to the enrollment file name

e.g.:

e_paperless=y

paperlessFile=sfcems5_enrollment_02252022.txt



*5*. If <eStatementOption>and/or <eStatementEmailAddress> tag is missing, do create Print, do create eStatement Archival, and do create PDF archival.

Create a report providing a list of member numbers with<eStatementOption>== "B" andsend email to "fmartinez@sanfranciscofcu.com,[stephen.yee@infoimageinc.com,|mailto:stephen.yee@infoimageinc.com]tech4@sanfranciscofcu.com".

The report contain will contain a list of account numbers and should be placed in secure4 ftp server.

Here's the body of the email and the report file naming convention listed below.

*SUBJECT*: SFCE ${Application Name}:Corelation eStatementOptiontag == B

*BODY*:

Dear Valued Customer,

During processing we detected <eStatementOption> == B (E-statement and mail statement) into XML file. A printed statement will go out to your members. Please go to the FTP client_pickup folder to download the following report containing a list of account numberswith this XML tagto research:

sfce${jid}_B_xml_corelation.txt



Thank You,



Data Center

InfoIMAGE Inc.

650.473.6388

[Data_Center@infoimageinc.com|mailto:Data_Center@infoimageinc.com]


author: rony
comment: Hi [~William.Kong]

I checked the I3.socket.pl script and it looks like triggering for the paperless file is happening after triggering for ISD index file which violets point 4 in the description.

!image-2022-02-28-01-52-40-293.png!








author: rony
comment: Hi [~William.Kong]

sanamv1 is using e_paperless and looks like we don't need to call I3.socket from main processing script , I3.socket call from move_afp_threads is handling it and just need to put the enrollment file in isd directory , export paperless and e_paperless.



But I3.socket only gets called if the e_automate flag is turned on and currently it's not in the control file for any of the prefixes mentioned in the description. Should we also turn this flag on?

Thanks


author: william.kong
comment: [~rony]: Did you update the comment incorrectly in this ticket? This project is related to SFCE and not SANA.



Also, I will need to be updating this SFCE description. There is additional logic update mentioned in this EPIC:[IMPL-1905] SFCE eStatement Delivery Preference Update - Jira (infoimageinc.com)


author: rony
comment: Hi [~William.Kong]

I mentioned sanamv1 as a reference.

When you said in the description

_e_paperless=y_

_paperlessFile=sfcems5_enrollment_02252022.txt_



I searched some scripts where those flags were used and sanamv1 is one of those. Please check my previous 2 comments and provide your feedback.



Thanks






author: rony
comment: Hi [~William.Kong]

When you have time please check those above 2 comments and give your comments.

https://jira.infoimageinc.com/browse/IS-820?focusedCommentId=30594&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-30594



https://jira.infoimageinc.com/browse/IS-820?focusedCommentId=30595&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-30595




author: rony
comment: Hi [~William.Kong]let me know your feedback.


author: william.kong
comment: [~rony]: Scope as changed a bit to whenever processing program does not see <eStatementOption> and/or <eStatementEmailAddress> tag. Report needs to be created and email needs to be sent. Do not create paper (i.e. NON-PRINT), do not create eStatemenet (i.e. non-estmt) but still create a statement for the PDF archival. See #5 in description of work for the specs and email language. I updated due date to be 3/31/2022. Please confirm if this ok.



As for your comments above, you can go ahead and call the paperless option+after+ triggering the index file via PUI; And yes, please active e_automate='y'


author: rony
comment: HI [~William.Kong]

yes, live date 3/31/2022 is ok.


author: william.kong
comment: Updated specs to specify secure4 (i.e. infoftps4/sfce/client_pickup folder) & fixed report file naming convention to no include pgp since there is no pgp encryption. Just use plain text.


author: rony
comment: Hi [~William.Kong]

one thing to confirm, if

eStateementOption isM Mail statement only , do we need to suppress the estatement?



Thanks




author: rony
comment: Hi [~William.Kong]

Another thing to confirm, ifeStatementEmailAddress is missing do we need to suppress from both paper and estatement? The email that we are sending is saying so.

__

_Dear Valued Customer,_

_During processing we detected eStatementOption and/or *eStatementEmailAddress* XML tag was missing during processing. The *print statement and eStatement will not be generated*. However, the PDF will have a copy of this statements. Please go to the FTP client_pickup folder to download the following report containing a list of account numbers missing these XML tags to research:_

Thanks




author: william.kong
comment: [~rony]: Please see my responses below:



+*Item #1:*+

eStatementOption have the following options
 * [M Mail statement only (Print) (Status = P in ISD enrollment file)|https://owa.infoimageinc.com/owa/redir.aspx?C=V5PdpqwhgggBlqWzIu1xAZnyPmSmhYcDCDNIoM39Nq3nJVOayYHZCA..&URL=https%3a%2f%2fowa.infoimageinc.com%2fowa%2fredir.aspx%3fSURL%3dK_YcG0zvPl6Rk0scy08-ItTvoHgEkBDUuJTfV8lN9n4hJpBeN4HUCGgAdAB0AHAAOgAvAC8AdwB3AHcALgBpAG4AZgBvAGkAbQBhAGcAZQBpAG4AYwAuAGMAbwBtAC8A%26URL%3dhttp%253a%252f%252fwww.infoimageinc.com%252f]

{color:#de350b}M == Print Statement; Include in eStatement index file for posting.{color}



+*Item #2:*+

Another thing to confirm, ifeStatementEmailAddress is missing do we need to suppress from both paper and estatement? The email that we are sending is saying so.

{color:#de350b}Yes, if email address is missing, do not print and do not create afp for eStatement for posting (i.e. put in nonEstmt category). Also, you still need to create PDF Archival.{color}




author: rony
comment: Hi [~William.Kong]

Forgot to confirm, per description:
 * [E E-statement only  (eSup2) (Status = E in ISD enrollment file)|https://owa.infoimageinc.com/owa/redir.aspx?C=V5PdpqwhgggBlqWzIu1xAZnyPmSmhYcDCDNIoM39Nq3nJVOayYHZCA..&URL=https%3a%2f%2fowa.infoimageinc.com%2fowa%2fredir.aspx%3fSURL%3dK_YcG0zvPl6Rk0scy08-ItTvoHgEkBDUuJTfV8lN9n4hJpBeN4HUCGgAdAB0AHAAOgAvAC8AdwB3AHcALgBpAG4AZgBvAGkAbQBhAGcAZQBpAG4AYwAuAGMAbwBtAC8A%26URL%3dhttp%253a%252f%252fwww.infoimageinc.com%252f]

so we will suppress from the paper and route those accounts to esup2?

Thanks




author: rony
comment: Hi [~William.Kong]

Just to confirm do we need to route the customers to esup2 who is
 * [E E-statement only  (eSup2) (Status = E in ISD enrollment file)|https://owa.infoimageinc.com/owa/redir.aspx?C=V5PdpqwhgggBlqWzIu1xAZnyPmSmhYcDCDNIoM39Nq3nJVOayYHZCA..&URL=https%3a%2f%2fowa.infoimageinc.com%2fowa%2fredir.aspx%3fSURL%3dK_YcG0zvPl6Rk0scy08-ItTvoHgEkBDUuJTfV8lN9n4hJpBeN4HUCGgAdAB0AHAAOgAvAC8AdwB3AHcALgBpAG4AZgBvAGkAbQBhAGcAZQBpAG4AYwAuAGMAbwBtAC8A%26URL%3dhttp%253a%252f%252fwww.infoimageinc.com%252f]

?


author: william.kong
comment: [~rony]: Description of work #5 changed again. Please review updated specs. Yes, route to eSup2 category if eStatement option flag is set to E.


author: rony
comment: Hi [~stephen.yee@infoimageinc.com]



Need a favor for visa. Would you please check if the client can provide us a cycle that contains*E-statement and mail statement*value for *eStatementOption*tag.



Thanks

Rony


author: stephen.yee@infoimageinc.com
comment: See attached [~rony]

[^KSVI-806_20220326_015645_000.Statement_Production_Visa_Platinum041522.xml]


author: rony
comment: Hi [~stephen.yee@infoimageinc.com]

This has estatement only value.

!image-2022-04-18-16-46-49-711.png!

But for testing, I need a data file with*E-statement and mail statement*value. Without it, I cannot generate the email mentioned in point 5 in description.






author: stephen.yee@infoimageinc.com
comment: Hi [~rony]- From the CU...

_In the file I sent, serial 3646 does not have an e-statement tag andserial 70757 does. Can you please double-check?_


author: rony
comment: Hi [~stephen.yee@infoimageinc.com]

what I am asking for I need an example where the*eStatementOption*tag value is*E-statement and mail statement*not just*E-statement only.*

Without this value, I cannot generate the email mentioned in point 5 in description.

_*Create a report providing a list of member*_ *number**s* _*with<eStatementOption>== "B" andsend email to.....*_

__Thanks


author: rony
comment: Hi [~stephen.yee@infoimageinc.com]

Hope you are not confused about what I am asking for. Please let me know.



Thanks

Rony


author: stephen.yee@infoimageinc.com
comment: [~rony]- CU is working on the test file now :)


author: stephen.yee@infoimageinc.com
comment: [~rony]- From the CU...

Apologies for the long wait, find attached data file that contains 
paper, e-statement, and both scenarios.

[^KSVI-806_20220326_015645_000.Statement_Production_Visa_Platinum042522.xml]


author: stephen.yee@infoimageinc.com
comment: [~rony]- Please advise. We need to test and roll this out ASAP.


author: rony
comment: Hi [~stephen.yee@infoimageinc.com]

Per ISD story index file posted without error. I will provide to qa tomorrow.


author: rony
comment: Hi [~Igor.Khosid]

Parallel id:20220227094940

project SFCEMV41.zip is in qa folder. This single project handles mv4,5,6.



index file and enrollment files are:

mv5_20220421_1_20220516_0340_sfce.txt ,mv5_enrollment_04222022.txt

mv6_20220325_1_20220516_0348_sfce.txt,mv6_enrollment_03262022.txt

mv4_enrollment_01312022.txt,mv4_20220131_1_20220516_0315_sfce.txt



This also covers is 818 and 819.



Thanks

Rony




author: igor.khosid
comment:    Parallel ID: 20220227094940
   Currently in parallel: Yes
   User: ronyD
   Description: is-820 enrollment
   Date Submitted: 2022-02-27 09:50:30
   Date Last Updated: 2022-05-16 03:46:35
   Files:
      1) SFCEMV41.dfa
      2) SFCEMV41.prj
      3) sfcemv4_process.sh
      4) sfce_ecl_enrollment_handler.sh
      5) sfcemv4.control
      6) sfcemv5.control
      7) sfcemv6.control
      8) sfcemv6_process.sh
      9) sfcemv5_process.sh


author: nprimak
comment: [~rony] [~William.Kong] [~Igor.Khosid]

Verified Visa statements from processed index files on InfoTrac staging.

Thank you,

Natasha


author: igor.khosid
comment: [~rony] - Please attach IS checklist - for all applications


author: rony
comment: Hi [~Igor.Khosid]

[^IS_820_Checklist.docx]


author: igor.khosid
comment: IS checklist - attached >>> [^IS_820_SFCE IS Checklist.pdf] 


author: rony
comment: Hi [~TunA]

Need help to release this.

SFCEMV41.dfa
 sfce_ecl_enrollment_handler.sh
 sfcemv4.control
 sfcemv4_process.sh
 sfcemv5.control
 sfcemv5_process.sh
 sfcemv6.control
 sfcemv6_process.sh



This will also release is-818, is-819.



[~stephen.yee@infoimageinc.com]

Thanks

Rony


author: tuna
comment: Hi [~rony],

Following codes have been released.

Thanks,

Tun



20220519121303 05/19/2022 ronyD IS-820 SFCE [22912] [pvt] eStatement Delivery Preference Update

[main@rhs ~]$ ll /d/is/cvs/xfer/ronyD/
total 864
-rwxrwxrwx 1 ronyD DSI 4458 May 19 12:01 sfce_ecl_enrollment_handler.sh
-rwxrwxrwx 1 ronyD DSI 118510 May 19 12:00 SFCEMV41.dfa
-rwxrwxrwx 1 ronyD DSI 1332 May 19 12:00 sfcemv4.control
-rwxrwxrwx 1 ronyD DSI 18809 May 19 12:00 sfcemv4_process.sh
-rwxrwxrwx 1 ronyD DSI 1304 May 19 12:01 sfcemv5.control
-rwxrwxrwx 1 ronyD DSI 18223 May 19 12:00 sfcemv5_process.sh
-rwxrwxrwx 1 ronyD DSI 1333 May 19 12:01 sfcemv6.control
-rwxrwxrwx 1 ronyD DSI 19741 May 19 12:00 sfcemv6_process.sh







[~stephen.yee@infoimageinc.com]


